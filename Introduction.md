# 药物逆合成（Retrosynthesis）

## 逆合成的基本背景介绍

在化学研究中，由简单的原料开始合成一个复杂化合物往往是非常困难的，而从想要制造的化合物分子开始，分析可以通过哪些容易得到的试剂和反应序列来合成，上述方法被称为**逆合成（Retrosynthesis）**，因其简单有效的特点被广泛应用于药物合成工艺路线设计。具体而言，逆合成是从**目标产物（product）**出发，通过逆向切断、连接、重排以及官能团互换、添加、去除等方法，将其变换成若干中间产物或原料，然后重复上述分析，直至通过**中间体（合成子，synthon）**得到价廉易得的合成子**等价试剂（reactant）**为止。通过对逆合成概念的阐述，可以大致将步骤分为两个阶段：（a）识别反应中心并将其切断，从而得到合成子。（b）将合成子通过互换、添加、重排等方法进行连接。不断重复上述步骤便可得到理想的等价试剂。

尽管逆合成与正向合成法相比较为简单高效，目前仍然具有相当的挑战性：首先是由于其涉及到的化学分子规模较大，导致逆合成方法在具体实施起来有着较高的资源壁垒。相关报告指出，目前已有的有机合成材料共包含$10^7$个反应试剂和产物，因此为了解决上述问题，使用深度学习模型来模拟逆合成便成为了首选方法。然而另一方面，目前的深度学习模型对反应机理的不彻底性理解增加了药物逆合成的难度，即使是化学专家，遇到具有多种可行的逆合成路线时，也很难做出合理有效的抉择。一个自然的解决方法油然而生：能否通过将人类知识注入模型中，从而达到获取合理的逆合成路线的目的。

## 逆合成方法介绍

目前基于深度学习模型的逆合成研究工作大致可分为两类：（a）模板化方法；（b）无模板方法。

### 模板化方法（Template-based methods）

模板化方法依赖于反应模板（预先设置的反应规则）来对化学反应中的分子变化过程进行复杂的编码，并依据编码后的序列进行合成试剂的预测。尽管大多数工作在准确率指标上实现了sota，在实验角度证明了所提出方法的有效性，但由于模板化方法只能在反应模板已经覆盖的化学空间中进行合理化探索，选择合适的模板对目标产物进行逆合成路线分析，因此模板化方法有明显的局限性：在指数级的化学反应空间中，只能推断有限的反应试剂，在发现新反应试剂的方面缺乏可扩展性，并往往存在较高的计算开销。

### 无模板方法（Template-free methods）

为了提高逆合成方法的可扩展性，相关学者提出了无模板化方法，将逆合成分析进一步分为两个子问题：i）反应中心识别（center identification）；ii）合成子的重组（synthon completion）。

反应中心识别能够在不使用反应模板的情况下将目标分子中特定位置（反应中心）的键断开，得到一系列的合成子，从而达到增加模型可扩展性的目的。而合成子重组则是通过一系列互换、添加、重排等方法将合成子进行重新拼接，使反应试剂生成步骤得到进一步简化。

## 逆合成数据集介绍



### USPTO-50K



### USPTO-full



## 逆合成评估指标

